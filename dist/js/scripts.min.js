var wordCloudApp=wordCloudApp||{};wordCloudApp.TopicListView=Backbone.View.extend({template:_.template($("#topicTemplate").html()),tagName:"div",className:"topic-link-wrapper",events:{"click .topic-link":"viewTopicDetail"},render:function(){return this.$el.html(this.template(this.model.attributes)),this},viewTopicDetail:function(){var e=new wordCloudApp.TopicView(this.model);e.render()}});var wordCloudApp=wordCloudApp||{};wordCloudApp.TopicView=Backbone.View.extend({el:"#topic-detail",tagName:"div",template:_.template($("#topic-detail-template").html()),initialize:function(){this.render()},render:function(){return this.$el.html(this.template(this.attributes)),this}});var wordCloudApp=wordCloudApp||{};wordCloudApp.TopicsCollectionView=Backbone.View.extend({el:"#topics-container",initialize:function(){this.collection=new wordCloudApp.TopicsCollection,this.render(),this.listenTo(this.collection,"reset",this.render),this.collection.fetch({reset:!0,error:function(){console.log("Unable to fetch Topics collection.")}})},render:function(){this.collection.each(function(e){this.renderTopic(e)},this)},renderTopic:function(e){var t=new wordCloudApp.TopicListView({model:e});this.$el.append(t.render().el)}});var wordCloudApp=wordCloudApp||{};wordCloudApp.TopicModel=Backbone.Model.extend({initialize:function(e,t){this.setColor(),this.setFontSize(t.collection.rangeCutOffs)},setColor:function(){var e=this.get("sentimentScore"),t="grey-text";e>60?t="green-text":e<40&&(t="red-text"),this.set("color",t)},setFontSize:function(e){var t=this.get("volume"),o=["xs","s","md","lg","xl","xxl"],i=_.find(e,function(e){return t<=e}),n=o[e.indexOf(i)];this.set("fontSize",n)}});var wordCloudApp=wordCloudApp||{};wordCloudApp.TopicsCollection=Backbone.Collection.extend({model:wordCloudApp.TopicModel,url:"js/topics.json",initialize:function(){},parse:function(e){var t=e.topics;return this.rangeCutOffs=this.findSizes(t),t},findSizes:function(e){var t=this.getVolumesArr(e),o=Math.ceil(t.length/6),i=[];return _.each(t,function(e,t){(t+1)%o===0&&i.push(e)}),i},getVolumesArr:function(e){var t=[];return _.each(e,function(e){t.push(e.volume)},this),t.sort(function(e,t){return e-t}),t}});var wordCloudApp=wordCloudApp||{},wordCloudApp=wordCloudApp||{};$(function(){new wordCloudApp.TopicsCollectionView});